---
title: Unionization and NAEP Data
author: R package build
date: '2021-05-17'
slug: unionization-and-naep-data
categories: []
tags: []
description: ''
---
```{r include = FALSE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
```

# Introduction

As a former teacher, I'm often intrigued by the way in which education issues provoke such strong feelings among non-educators.  Teacher unions tend to elicit particularly strong opinions.  

Since so many people have strong opinions about unions, I decided to perform a state-level exploratory analysis of the relationship between test scores and unionization rates. 

# Standard Correlation vs. Causation Caveat 
These data are purely correlational.  Any inferences made based these charts should be taken with a grain of salt!

# Finding Test Scores Data

### NAEP
I used NAEP data for the state-level math and reading scores.  
[NAEP](https://nces.ed.gov/nationsreportcard/about/) stands for National Assessment of Education Progress.  It is administered by the NCES (National Center for Education Statistics ) to students across the United States.  It is often referred to as the "Nation's Report Card" for several reasons: 

1. It is generally considered to be high quality
2. It has been administered every few years since 1969.
3. Unlike high stakes exams, the same test is administered across the nation. 


### Why focus on 8th grade test scores?
Each assessment year, a representative sample of students from grades 4, 8, and 12 take the test.  I focus on grade 8 instead of grade 12 because there is some concern that seniors do not take the test as seriously ([See here](https://dianeravitch.net/2015/11/11/a-note-to-marc-tucker-why-i-disagree-with-your-analysis-of-naep-scores/)).  Consequently, grade 8 is the latest grade for which we have data before "senioritis" becomes a concern. 


# Obtaining the Data

### Unionization Data 
After a great deal of searching, I was able to find 2017-2018 state-level unionization rates from the [National Teacher and Principal Survey](https://nces.ed.gov/surveys/ntps/tables/ntps1718_20111201_t1s.asp).
Unfortunately, there was no data from Maryland or DC due to low response rates. 


### NAEP Data 
The NAEP data was much easier to find.  There is an easy-to-use [data portal](https://www.nationsreportcard.gov/ndecore/xplore/NDE) on their website.  You can simply select the year, grade-level, subject, and jurisdiction you are looking for.  I used this tool to create two state-level datasets with the 2019 math and reading NAEP results. 



```{r data_import}
library(dplyr)
library(ggplot2)
library(ggrepel)

setwd('../../..')
naep_mth <- read.csv('data/state_naep_mth2019.csv')
naep_ela <- read.csv('data/state_naep_ela2019.csv')
pct_union <- read.csv('data/state_pct_union.csv')
                 
ed_dta <- naep_mth %>% 
            inner_join(naep_ela, by = 'State')  %>% 
            inner_join(pct_union, by = 'State') 
          
state_abb <-   append(state.abb, 'DC', after =8) 

ed_dta <- ed_dta %>% 
            rename(state_name = State) %>% 
            mutate(state = state_abb)

ed_dta %>%  head()

```


# Visualizations

## Reading Tests and Unionization

I used ggplot to create a scatterplot of ELA NAEP scores over unionization rates by state.  I used the geom_text_repel() function from Kamil Slowikowski's [ggrepel)](https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html) to ensure that there none of the labels overlap one another.  Finally, I used geom_smooth to create a fitted OLS regression line.

```{r ela_union_plot}
ed_dta %>% 
  filter_all(~!is.na(.)) %>% 
  ggplot(aes(x=pct_union, y= naep_ela_2019, label = state)) +
  geom_point() +
  geom_text_repel(size = 2) +
  geom_smooth(method = 'lm', 
              se = FALSE, 
              linetype = 'dashed', 
              color = 'red', 
              size = 0.5) +
  theme_bw() +
  theme(panel.grid = element_blank())+
  scale_x_continuous(limits = c(0,100)) 
```

Based on the graph, there may be a correlation between ELA NAEP and unionization although again.   Of course,we know that correlation is not causation!     

However, you could argue that if we remove Massachusetts and the trend line, the positive relationship would not be so apparent.  Massachusetts has traditionally been the state with highest test scores, and, as do many other states in the Northeast, it also happens to have a high unionization rate.

```{r ela_union_cor}
cor(ed_dta$naep_ela_2019, ed_dta$pct_union, use = 'complete.obs')  %>%  round(2)
```

The correlation between state-level NAEP reading scores and unionization is .32, which is weak to moderate.  

```{r ela_union_lm}
fit <- lm(naep_ela_2019 ~ pct_union, ed_dta)
summary(fit)

```

The coefficient of unionization is statistically significant.  Of course, this evidence is just correlational, so we shouldn't overinterpret this result. 

## Math Tests and Unionization

I also plotted NAEP math scores over unionization.   The correlation appears to be weaker based on the scatterplot.

```{r math_union_plot}
ed_dta %>% 
  filter_all(~!is.na(.)) %>% 
  ggplot(aes(x=pct_union, y= naep_mth_2019, label = state)) +
  geom_point() +
  geom_text(position = position_dodge(width = 0.1), vjust = 2, size = 2) +
  geom_smooth(method = 'lm', 
              se = FALSE, 
              linetype = 'dashed', 
              color = 'red', 
              size = 0.5) +
  theme_bw() +
  theme(panel.grid = element_blank()) +
  scale_x_continuous(limits = c(0,100)) 
```

Indeed, the Pearson correlation coefficient is below .3.
```{r ela_union_cor}
cor(ed_dta$naep_mth_2019, ed_dta$pct_union, use= "complete.obs") %>% 
  round(2) 
```

Finally, we can observe that relationship is not statistically significant at the .05 threshold. 

```{r ela_union_lm}
fit <- lm(naep_mth_2019 ~ pct_union, ed_dta)
fit %>%  summary
```



## Plotting Math and ELA Together 

After creating the two previous graphs, I noticed that there were a few states that appeared near the top in one subject and not the other.  For example Minnesota was ranked third in Math in 2019 but was ranked seventeenth in ELA.  On the other hand, Connecticut was ranked second in reading and only ninth in math.

```{r ela_math_rank}
ed_dta <- ed_dta %>% 
          mutate(naep_mth_rnk_2019 = rank(-naep_mth_2019, ties.method = 'min'),
                 naep_ela_rnk_2019 = rank(-naep_ela_2019, ties.method = 'min'))


ed_dta %>% 
  filter(state %in% c('MN', 'CT')) %>% 
  select(state_name, naep_mth_rnk_2019,naep_ela_rnk_2019)
```

I decided explore the relationship between reading and math scores by creating another scatterplot with reading scores on the y-axis and math scores on the x-axis.
In this plot, the relationship between reading and math test scores are clearly more highly correlated than the relationships we saw in the previous plots.

```{r ela_math_plot}
ed_dta %>% 
  ggplot(aes(x=naep_mth_2019, y= naep_ela_2019, label = state)) +
  geom_point() +
  geom_text_repel(size = 2) +
  geom_smooth(method = 'lm', 
              se = FALSE, 
              linetype = 'dashed', 
              color = 'red',
              size = 0.5) +
  theme_bw() +
  theme(panel.grid = element_blank()) 
```  

The relationship between math and reading NAEP scores was statistically significant, as was fairly obviously from the scatterplot as well.

```{r}
fit <- ed_dta %>%  
  lm(formula =naep_ela_2019 ~ naep_mth_2019)
summary(fit)
```

The Pearson correlation coefficient was 0.89, indicating a strong correlation between the two.

```{r ela_math_cor}
cor(ed_dta$naep_mth_2019, ed_dta$naep_ela_2019) %>%  round(2)

```



## Ploting Math and ELA with Unionization as a Categorical Factor

In order to retain the unionization rates, I created a factor that binned this variable into two categorizes based on an 80% threshold.  


```{r}

ed_dta <-ed_dta %>% 
  mutate(unionized = as.factor(if_else(pct_union >= 80,  "80% or Above", "Below 80%")))

  ed_dta %>% 
  filter_all(~!is.na(.)) %>% 
  ggplot(aes(x=naep_mth_2019, y= naep_ela_2019, 
              label = state, color = unionized, group = unionized)) +
  geom_point() +
  geom_text_repel(size = 2) +
  geom_smooth(method = 'lm', 
              se = FALSE, 
              linetype = 'dashed', 
              color = 'gray', size = 0.5, 
              inherit.aes = FALSE,
              aes(x=naep_mth_2019, y = naep_ela_2019)) +
  theme_bw() +
  theme(panel.grid = element_blank())  +
    scale_color_manual(values = c('blue', 'red'))

```

One thing that seemed interesting to me based on this final graph was that Wisconsin seemed liked an outlier in that it was the only state in the Great Lakes region that had a unionization rate below 80%.  Also among the states below the 80% unionization threshold, it had the highest math score and among the highest reading scores.  Of course, again this evidence is completely descriptive.  That being said I do find plotting reading and math together gives a fuller picture of student performance.


# What I find Interesting

Of course, it's not very surprising that reading and math scores are highly correlated . What I find more interesting are the states in which students performed better in one subject than the other. For example, Alaska, Texas, and Minnesota seem to have much lower ELA scores than you would expect given their math scores.  This is apparent based on how far they lie below the regression line.  On the other hand, based on how far it lies above the regression,Connecticut has much lower math scores given what you predict given its reading scores. 

Observing these outliers generates some new interesting questions that I hadn't thought about when I first tackled.  
 - Why do some states do better on one subject compared to another (or is it just noise)?  
  - Is there something about Texas, Alaska, and Minnesota that explains their  in math relative to reading?  
  
These questions seems potentially more interesting than the unionization relationship because the correlation in the first two plots was much weaker and confounding was likely to be an issue.  


# Conlusions
1. Running into obstacles while trying new things can open new doors.  Having difficulty creating plots wihtout overlapping state labels led me to find ggrepel, which is a really cool package.
2. Sometimes, exploring data can lead to more interesting questions than you had apriori.
3. It is often useful to explore as more than one dimension.  The math/reading scatterplots helped us to look at two dimension of student performance that weren't evident in the first two plots.  
